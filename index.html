<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุฑู ุญุณูู ุงูุฏูููู - ูุธุงู ุฅุฏุงุฑุฉ ุงููุฑู</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <button onclick="logout()" class="logout-btn">
                <span>๐ช</span>
                <span>ุชุณุฌูู ุงูุฎุฑูุฌ</span>
            </button>
            <h1>๐ ูุฑู ุญุณูู ุงูุฏูููู ๐</h1>
            <p>ูุธุงู ุฅุฏุงุฑุฉ ุงููุฑู ุงูุฐูู</p>
        </header>

        <nav>
            <ul>
                <li><a href="index.html" class="active">ุงูุฑุฆูุณูุฉ</a></li>
                <li><a href="dough.html">ุงูุนุฌูุงุช ุงูููููุฉ</a></li>
                <li><a href="electric.html"> ุงูููุฑุจุงุฆู</a></li>
                <li><a href="differences.html">ุงููุฑููุงุช</a></li>
                <li><a href="dough_records.html">ุณุฌู ุงูุนุฌูุงุช</a></li>
                <li><a href="expenses.html">ุงููุตุงุฑูู</a></li>
                <li><a href="profit.html">ุงูุฑุจุญ ุงูููุงุฆู</a></li>
            </ul>
        </nav>

        <div class="cards-grid" id="statsCards">
            <div class="card">
                <div class="card-title">ุนุฌูุงุช ุงูููู</div>
                <div class="card-value" id="todayDough">0</div>
                <div class="card-label">ุนุฌูุฉ</div>
            </div>

            <div class="card">
                <div class="card-title">ุงูุฑุจุญ ุงููุชููุน</div>
                <div class="card-value" id="todayProfit">0</div>
                <div class="card-label">ุฃูู ุฏููุงุฑ</div>
            </div>

            <div class="card">
                <div class="card-title">ูุตุงุฑูู ุงูููู</div>
                <div class="card-value" id="todayExpenses">0</div>
                <div class="card-label">ุฏููุงุฑ</div>
            </div>

            <div class="card">
                <div class="card-title">ุตุงูู ุงูุฑุจุญ</div>
                <div class="card-value" id="todayNetProfit">0</div>
                <div class="card-label">ุฃูู ุฏููุงุฑ</div>
            </div>
        </div>

        <p style="text-align: center; color: var(--light-gray); margin-top: 15px; font-size: 0.9rem;">
            ๐ก ุงูุฃุฑุจุงุญ ูุนุฑูุถุฉ ุจุงูุฃูู ุฏููุงุฑ ููุชุจุณูุท | ุงููุตุงุฑูู ุจุงูุฏููุงุฑ ุงูุนุงุฏู
        </p>

        <div class="btn-group">
            <a href="dough.html" class="btn btn-primary">ุฅุถุงูุฉ ุนุฌูุงุช ุฌุฏูุฏุฉ</a>
            <a href="profit.html" class="btn btn-primary">ุนุฑุถ ุงูุชูุงุฑูุฑ ุงูููุตูุฉ</a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <script src="db.js"></script>
    <script src="auth-check.js"></script>
    <script>
        // ุชุญุฏูุซ ุงูุจูุงูุงุช ุนูุฏ ุชุญููู ุงูุตูุญุฉ
        async function updateDashboard() {
            const stats = await db.getStats('today');
            
            // ุชุญุฏูุซ ุงูุจุทุงูุงุช ุงูุฑุฆูุณูุฉ
            animateNumber('todayDough', stats.doughCount, 0);
            animateNumber('todayProfit', stats.profit, 0, true);
            animateNumber('todayExpenses', (stats.flourCost + stats.expenses), 0, true);
            animateNumber('todayNetProfit', stats.netProfit, 0, true);
        }

        // ุชุญุฑูู ุงูุฃุฑูุงู (Animation)
        function animateNumber(elementId, targetValue, decimals = 2, useThousands = false) {
            const element = document.getElementById(elementId);
            const startValue = 0;
            const duration = 1000; // ูุฏุฉ ุงูุฃููููุดู ุจุงูููู ุซุงููุฉ
            const increment = targetValue / (duration / 16); // 60fps
            let currentValue = startValue;

            const timer = setInterval(() => {
                currentValue += increment;
                if (currentValue >= targetValue) {
                    currentValue = targetValue;
                    clearInterval(timer);
                }
                
                if (useThousands) {
                    element.textContent = formatThousands(currentValue, decimals);
                } else if (decimals === 0) {
                    element.textContent = Math.floor(currentValue).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
                } else {
                    element.textContent = formatNumber(currentValue);
                }
            }, 16);
        }

        // ุชุญููู ุงูุจูุงูุงุช ุนูุฏ ูุชุญ ุงูุตูุญุฉ
        document.addEventListener('DOMContentLoaded', async () => {
            await updateDashboard();
            
            // ุชุญุฏูุซ ุชููุงุฆู ูู 30 ุซุงููุฉ
            setInterval(updateDashboard, 30000);
        });
    </script>
</body>
</html>

